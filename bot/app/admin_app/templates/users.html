<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Пользователи</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #121212;
            color: #ffffff;
            margin: 20px;
        }

        h1 {
            color: #1DB954;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: #181818;
            color: #ffffff;
        }

        table, th, td {
            border: 1px solid #282828;
        }

        th, td {
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #282828;
        }

        button {
            padding: 5px 10px;
            margin: 0 2px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit {
            background-color: #1DB954;
            color: white;
            width: 45%;
            padding: 10px;
        }

        .delete {
            background-color: #e91429;
            color: white;
            width: 45%;
            padding: 10px;
        }

        .add {
            background-color: #1DB954;
            color: white;
            padding: 10px 20px;
            margin: 0 0 20px 0;
        }

        #addUserForm, #updateUserForm {
            background-color: #181818;
            padding: 20px;
            border: 1px solid #282828;
            border-radius: 8px;
            margin: 0 0 25px 0;
        }

        input {
            background-color: #121212;
            border: 1px solid #282828;
            color: #ffffff;
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
            width: calc(100% - 16px);
        }

        input:focus {
            outline: none;
            border-color: #1DB954;
        }

        #searchBox {
            margin: 0 0 20px 0;
            padding: 11px;
        }

        #searchBox:hover{
            border: solid 1px #1db954;
        }

        a {
            text-decoration: none;
            color: #1db954;
        }

        a:hover {
           color: #14843c;
        }
    </style>
</head>
<body>
<h1><a href="/api/admin/home">Admin Панель</a> - Пользователи</h1>
<input type="text" id="searchBox" placeholder="Поиск по имени или телефону" oninput="filterUsers()">
<button class="add" onclick="showAddUserForm()">Добавить пользователя</button>
<div id="addUserForm" style="display: none;">
    <h2>Добавление пользователя</h2>
    <label for="addName">Имя:</label>
    <input type="text" id="addName" name="name">
    <br><br>
    <label for="addPhone">Телефон:</label>
    <input type="text" id="addPhone" name="phone">
    <br><br>
    <label for="addEmail">Email:</label>
    <input type="email" id="addEmail" name="email">
    <br><br>
    <button class="add" onclick="addUser()">Подтвердить</button>
    <button onclick="hideAddUserForm()" style="background-color: #282828; color: #ffffff; padding: 11px">Отмена</button>
</div>
<div id="updateUserForm" style="display: none;">
    <h2>Изменение пользователя</h2>
    <label for="updateName">Имя:</label>
    <input type="text" id="updateName" name="name">
    <br><br>
    <label for="updatePhone">Телефон:</label>
    <input type="text" id="updatePhone" name="phone">
    <br><br>
    <label for="updateEmail">Email:</label>
    <input type="email" id="updateEmail" name="email">
    <br><br>
    <button class="add" onclick="updateUser()">Подтвердить</button>
    <button onclick="hideUpdateUserForm()" style="background-color: #282828; color: #ffffff; padding: 11px">Отмена</button>
</div>
<table id="userTable">
    <thead>
    <tr>
        <th>ID</th>
        <th>Имя</th>
        <th>Телефон</th>
        <th>Email</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    </tbody>
</table>
<script>
    let users = [
        {id: 1, name: 'John Doe', phone: '+79664563432', email: 'john.doe@example.com'},
        {id: 2, name: 'Jane Smith', phone: '+79453452233', email: 'jane.smith@example.com'}
    ];
    let currentEditId = null;

    function loadUsers(filteredUsers = users) {
        const tableBody = document.getElementById('userTable').querySelector('tbody');
        tableBody.innerHTML = '';
        filteredUsers.forEach(user => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${user.id}</td>
                <td>${user.name}</td>
                <td>${user.phone}</td>
                <td>${user.email}</td>
                <td>
                    <button class="edit" onclick="showUpdateUserForm(${user.id})">Изменить</button>
                    <button class="delete" onclick="deleteUser(${user.id})">Удалить</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    function filterUsers() {
        const query = document.getElementById('searchBox').value.toLowerCase();
        const filteredUsers = users.filter(user =>
            user.name.toLowerCase().includes(query) || user.phone.toLowerCase().includes(query)
        );
        loadUsers(filteredUsers);
    }

    function showAddUserForm() {
        document.getElementById('addUserForm').style.display = 'block';
    }

    function hideAddUserForm() {
        document.getElementById('addUserForm').style.display = 'none';
    }

    function addUser() {
        const name = document.getElementById('addName').value;
        const phone = document.getElementById('addPhone').value;
        const email = document.getElementById('addEmail').value;

        if (name && phone && email) {
            const newUser = {
                id: users.length ? users[users.length - 1].id + 1 : 1,
                name,
                phone,
                email
            };
            users.push(newUser);
            loadUsers();
            hideAddUserForm();
        } else {
            alert('Пожалуйста, заполните все поля');
        }
    }

    function showUpdateUserForm(id) {
        const user = users.find(u => u.id === id);
        if (user) {
            currentEditId = id;
            document.getElementById('updateName').value = user.name;
            document.getElementById('updatePhone').value = user.phone;
            document.getElementById('updateEmail').value = user.email;
            document.getElementById('updateUserForm').style.display = 'block';
        }
    }

    function hideUpdateUserForm() {
        document.getElementById('updateUserForm').style.display = 'none';
    }

    function updateUser() {
        const name = document.getElementById('updateName').value;
        const phone = document.getElementById('updatePhone').value;
        const email = document.getElementById('updateEmail').value;

        if (currentEditId && name && phone && email) {
            const userIndex = users.findIndex(u => u.id === currentEditId);
            if (userIndex > -1) {
                users[userIndex] = {id: currentEditId, name, phone, email};
                loadUsers();
                hideUpdateUserForm();
                currentEditId = null;
            }
        } else {
            alert('Пожалуйста, заполните все поля');
        }
    }

    function deleteUser(id) {
        users = users.filter(user => user.id !== id);
        loadUsers();
    }

    // Initial load
    loadUsers();
</script>
</body>
</html>
